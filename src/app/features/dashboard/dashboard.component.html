<div class="dashboard-container">
    <!-- Dashboard Header -->
    <header class="dashboard-header">
        <div class="header-left">
            <h1 class="dashboard-title">Supply Chain Control Tower</h1>
            <p class="dashboard-subtitle">Real-time operations overview</p>
        </div>

        <div class="header-right">
            <!-- Search -->
            <div class="header-search">
                <i class="pi pi-search"></i>
                <input type="text" placeholder="Search orders, SKUs, locations...">
            </div>

            <!-- Time Range Selector -->
            <div class="time-range-selector">
                <button *ngFor="let range of timeRanges" [class.active]="selectedTimeRange === range.value"
                    (click)="selectedTimeRange = range.value">
                    {{ range.label }}
                </button>
            </div>

            <!-- Notifications -->
            <button class="header-icon-btn notification-btn">
                <i class="pi pi-bell"></i>
                <span class="notification-badge" *ngIf="getCriticalAlertCount() > 0">
                    {{ getCriticalAlertCount() }}
                </span>
            </button>

            <!-- User Profile -->
            <div class="header-user">
                <div class="user-avatar">SC</div>
            </div>
        </div>
    </header>

    <!-- KPI Cards Row -->
    <section class="kpi-section">
        <app-kpi-card *ngFor="let kpi of kpis" [data]="kpi"></app-kpi-card>
    </section>

    <!-- Main Content Grid (Flow + Tabbed Panel) -->
    <section class="main-content">
        <!-- Transport Flow - 2/3 width -->
        <div class="flow-panel">
            <app-flow-diagram [nodes]="flowNodes" [links]="flowLinks"></app-flow-diagram>
        </div>

        <!-- Tabbed Panel - 1/3 width -->
        <div class="tabbed-panel">
            <div class="tab-header">
                <button class="tab-btn" [class.active]="activeTab === 'alerts'" (click)="activeTab = 'alerts'">
                    <i class="pi pi-exclamation-triangle"></i>
                    Alerts
                    <span class="tab-badge" *ngIf="getUnacknowledgedAlertCount() > 0">
                        {{ getUnacknowledgedAlertCount() }}
                    </span>
                </button>
                <button class="tab-btn" [class.active]="activeTab === 'warehouses'" (click)="activeTab = 'warehouses'">
                    <i class="pi pi-building"></i>
                    Warehouses
                </button>
            </div>

            <div class="tab-content">
                <app-alert-list *ngIf="activeTab === 'alerts'" [alerts]="alerts"></app-alert-list>
                <app-warehouse-status *ngIf="activeTab === 'warehouses'"
                    [warehouses]="warehouses"></app-warehouse-status>
            </div>
        </div>
    </section>

    <!-- AI Intelligence Section -->
    <section class="ai-section">
        <app-ai-forecast [forecastData]="forecastData" [insights]="insights"></app-ai-forecast>
    </section>
</div>